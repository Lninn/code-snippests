<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Frame based</title>

  <style>
    .div {
      width: 30px;
      height: 20px;
      position: relative;
    }

    .green {
      background-color: green;
    }

    .red {
      background-color: red;
    }

    .blue {
        background-color: blue;
    }
  </style>
</head>
<body>
  <div class="title">60 fps:</div>
  <div class="div green" id="div1"></div>
  
  <div class="title">30 fps:</div>
  <div class="div red" id="div2"></div>
  
  <div class="title">10 fps:</div>
  <div class="div blue" id="div3"></div>

  <script>
    function moveDiv(div, fps) {
      let left = 0
      let param = 1
      let time = null

      function loop() {
        update()
        draw()
      }

      function update() {
        left += param * 2

        if (left > 300) {
          left = 300
          param = -1
        } else if (left < 0) {
          left = 0
          param = 1
        }
      }

      function draw() {
        div.style.left = left + 'px'
      }

      time = setInterval(function() {
        loop()
      }, 1000 / fps)
    }

    function moveDivTimeBased(div, fps) {
      let left = 0
      let current = +new Date()
      let previus = +new Date()
      let param = 1

      function loop() {
        const current = +new Date()
        const dt = current - previus
        previus = current

        update(dt)
        draw()
      }

      function update(dt) {
        left += param * (dt * 0.12)

        if (left > 300) {
          left = 300
          param = -1
        } else if (left < 0) {
          left = 0
          param = 1
        }
      }

      function draw() {
        div.style.left = left + 'px'
      }

      time = setInterval(function() {
        loop()
      }, 1000 / fps)
    }

    function moveDivTimeBased2(div, fps) {
      let left = 0
      let current = +new Date()
      let previus = +new Date()
      let dt = 1000 / 60
      let acc = 0
      let param = 1

      function loop() {
        const current = +new Date()
        const passed = current - previus
        previus = current
        
        acc += passed
        while(acc >= dt) {
          update(dt)
          acc -= dt
        }

        draw()
      }

      function update(dt) {
        left += param * (dt * 0.12)

        if (left > 300) {
          left = 300
          param = -1
        } else if (left < 0) {
          left = 0
          param = 1
        }
      }

      function draw() {
        div.style.left = left + 'px'
      }

      time = setInterval(function() {
        loop()
      }, 1000 / fps)
    }

    moveDivTimeBased2(document.getElementById("div1"), 60);
    moveDivTimeBased2(document.getElementById("div2"), 30);
    moveDivTimeBased2(document.getElementById("div3"), 10);


  </script>
</body>
</html>